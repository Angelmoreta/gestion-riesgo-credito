{% extends 'base.html' %}
{% block title %}Libro · Riesgo de Crédito{% endblock %}

{% block extra_css %}
<style>
  .book-sidebar {
    position: sticky;
    top: 1rem;
    height: calc(100vh - 2rem);
    overflow-y: auto;
    padding-right: 1rem;
    border-right: 1px solid #eee;
  }
  .chapter-card {
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .chapter-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.1) !important;
  }
  .chapter-card .card-body {
    display: flex;
    flex-direction: column;
    height: 100%;
  }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
  <div class="row">
    <!-- Sidebar -->
    <div class="col-lg-3 col-xl-2 d-none d-lg-block">
      <div class="book-sidebar">
        <h5 class="mb-3">Índice</h5>
        <div class="list-group list-group-flush">
          <a href="#introduccion" class="list-group-item list-group-item-action active">
            1. Introducción
          </a>
          <a href="#conceptos-basicos" class="list-group-item list-group-item-action">
            2. Conceptos básicos
          </a>
          <a href="#metricas-clave" class="list-group-item list-group-item-action">
            3. Métricas clave
          </a>
          <a href="#modelos-validacion" class="list-group-item list-group-item-action">
            4. Modelos y validación
          </a>
          <a href="#gestion-cartera" class="list-group-item list-group-item-action">
            5. Gestión de cartera
          </a>
        </div>
        <div class="mt-4">
          <h6 class="text-muted mb-2">Capítulos</h6>
          <div class="d-grid gap-2">
            <a href="{% url 'libro_intro' %}" class="btn btn-sm btn-outline-primary">
              <i class="fas fa-book-open me-1"></i> Introducción
            </a>
            <button class="btn btn-sm btn-outline-secondary" disabled>PD (Próximamente)</button>
            <button class="btn btn-sm btn-outline-secondary" disabled>LGD (Próximamente)</button>
            <button class="btn btn-sm btn-outline-secondary" disabled>EAD (Próximamente)</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Contenido principal -->
    <div class="col-lg-9 col-xl-8">
      <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="{% url 'home' %}">Inicio</a></li>
          <li class="breadcrumb-item active" aria-current="page">Libro: Riesgo de Crédito</li>
        </ol>
      </nav>

      <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between mb-4">
        <div class="me-md-4">
          <h1 class="h3 mb-2">Libro: Riesgo de Crédito</h1>
          <p class="text-muted">Guía práctica con ejemplos interactivos y referencias regulatorias</p>
        </div>
        <div class="mt-3 mt-md-0
        ">
          <a href="{% url 'libro_intro' %}" class="btn btn-primary">
            <i class="fas fa-play me-1"></i> Empezar a leer
          </a>
        </div>
      </div>

      <div class="row g-4">
        <!-- Capítulo 1 -->
        <div class="col-12">
          <div class="card chapter-card h-100 shadow-sm">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <span class="badge bg-primary mb-2">Disponible</span>
                  <h2 class="h5 mb-3">1. ¿Qué es el riesgo de crédito?</h2>
                  <p class="text-muted">Introducción a los conceptos fundamentales, marco regulatorio (Basilea, EBA, IFRS 9) y primeros pasos en el análisis de riesgo crediticio.</p>
                </div>
                <div class="d-flex flex-column">
                  <span class="badge bg-light text-dark mb-2">3 lecturas</span>
                  <a href="{% url 'libro_intro' %}" class="btn btn-outline-primary btn-sm">
                    Ver capítulo <i class="fas fa-arrow-right ms-1"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Capítulos futuros -->
        {% for chapter in [
          {"title": "PD: Probabilidad de Incumplimiento", "desc": "Modelos de scoring, curvas ROC/AUC, calibración y seguimiento."},
          {"title": "LGD: Pérdida en Caso de Incumplimiento", "desc": "Cálculo de LGD, downturn LGD, colaterales y recuperaciones."},
          {"title": "EAD: Exposición en Caso de Incumplimiento", "desc": "CCF, líneas de crédito y exposición fuera de balance."}
        ] %}
        <div class="col-md-6 col-lg-4">
          <div class="card chapter-card h-100 opacity-75">
            <div class="card-body">
              <h2 class="h6 mb-3">{{ loop.index + 1 }}. {{ chapter.title }}</h2>
              <p class="small text-muted">{{ chapter.desc }}</p>
              <button class="btn btn-outline-secondary btn-sm w-100" disabled>Próximamente</button>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

      <div class="card border-0 bg-light mt-5">
        <div class="card-body text-center py-4">
          <h3 class="h5 mb-3">¿Listo para profundizar?</h3>
          <p class="text-muted mb-4">Accede a herramientas interactivas, plantillas descargables y ejemplos prácticos.</p>
          <a href="{% url 'libro_intro' %}" class="btn btn-primary px-4">
            <i class="fas fa-book-open me-2"></i> Comenzar con la introducción
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Smooth scroll para los enlaces del índice
document.querySelectorAll('.book-sidebar a[href^="#"]').forEach(anchor => {
  anchor.addEventListener('click', function (e) {
    e.preventDefault();
    const target = document.querySelector(this.getAttribute('href'));
    if (target) {
      target.scrollIntoView({ behavior: 'smooth' });
    }
  });
});
</script>
{% endblock %}
